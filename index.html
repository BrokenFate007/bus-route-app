<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IIT Palakkad Campus Bus Schedule</title>

  <!-- Mobile viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- PWA Manifest -->
  <link rel="manifest" href="./manifest.json">
  
  <!-- Favicon -->
  <link rel="icon" href="./icons/android-launchericon-192-192.png">
  <link rel="apple-touch-icon" href="./icons/android-launchericon-192-192.png">
  <link rel="shortcut icon" href="./icons/android-launchericon-192-192.png">
  
  <!-- Theme color - CHANGED TO DARK -->
  <meta name="theme-color" content="#0f172a">
  
  <!-- iOS specific -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="IITPKD Bus">
  <link rel="apple-touch-icon" href="./icons/android-launchericon-192-192.png">
  
  <!-- Description for SEO -->
  <meta name="description" content="Real-time bus schedules for IIT Palakkad campus shuttle and outside routes">
  
  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css">

  <!-- Google Analytics - ENHANCED VERSION -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0KC4TPQ1NK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    
    // Basic configuration
    gtag('config', 'G-0KC4TPQ1NK', { 
      anonymize_ip: true,
      send_page_view: true
    });
    
    // Track if app is installed (standalone mode)
    const isInstalled = window.matchMedia('(display-mode: standalone)').matches;
    gtag('event', 'page_view', {
      'app_mode': isInstalled ? 'installed_pwa' : 'web_browser'
    });
  </script>

</head>

<body>

  <main class="container">

    <h1>IIT Palakkad Campus Bus Schedule</h1>

    <!-- Clock -->
    <div id="clock" class="clock"></div>

    <!-- Install App Button -->
    <div id="installContainer" class="install-container hidden">
      <button id="installButton" class="install-btn">
        Install App
      </button>
    </div>

    <!-- ===== Next Bus ===== -->
    <div class="direction-buttons">
      <button id="btnNilaToSahyadri" class="dir-btn">
        Nila ‚Üí Sahyadri
      </button>

      <button id="btnSahyadriToNila" class="dir-btn">
        Sahyadri ‚Üí Nila
      </button>
    </div>

    <div id="results"></div>

    <!-- ===== Journey Planner (Campus) ===== -->
    <section class="journey">

      <button
        id="journeyToggle"
        class="journey-toggle"
        type="button">
        Plan a Journey (Campus)
        <span class="arrow">‚ñæ</span>
      </button>

      <div id="journeyPanel" class="journey-panel hidden">

        <!-- Day Selection (Full Width) -->
        <div class="journey-controls full">
          <select id="journeyDay" aria-label="Day">
            <option value="">Day</option>
          </select>
        </div>

        <!-- Time Picker (Full Width) -->
        <div class="journey-controls full">
          <div class="time-picker">
            <select id="journeyHour">
              <option value="">Hour</option>
            </select>

            <select id="journeyMinute">
              <option value="">Min</option>
            </select>

            <select id="journeyPeriod">
              <option value="">AM/PM</option>
              <option value="AM">AM</option>
              <option value="PM">PM</option>
            </select>
          </div>
        </div>

        <!-- From and To -->
        <div class="journey-controls">
          <select id="journeyFrom" aria-label="Boarding stop">
            <option value="">From</option>
          </select>

          <select id="journeyTo" aria-label="Destination stop">
            <option value="">To</option>
          </select>
        </div>

        <!-- Find Button -->
        <div class="journey-controls full">
          <button
            id="journeySearch"
            type="button">
            Find buses
          </button>
        </div>

        <div id="journeyResults" class="journey-results"></div>

      </div>
    </section>

    <!-- ===== Outside Campus Buses ===== -->
    <section class="journey outside-campus">

      <button
        id="outsideCampusToggle"
        class="journey-toggle"
        type="button">
        Outside Campus Buses
        <span class="arrow">‚ñæ</span>
      </button>

      <div id="outsideCampusPanel" class="journey-panel hidden">

        <div class="journey-controls outside-three-col">
          <select id="outsideDay" aria-label="Day">
            <option value="">Select Day</option>
          </select>

          <select id="outsideTimePeriod" aria-label="Time Period">
            <option value="">Time</option>
            <option value="all">All Day</option>
            <option value="morning">üåÖ Morning</option>
            <option value="afternoon">‚òÄÔ∏è Afternoon</option>
            <option value="evening">üåÜ Evening</option>
          </select>

          <select id="outsideDestination" aria-label="Destination">
            <option value="">Bus Stop</option>
          </select>
        </div>

        <div class="journey-controls full">
          <button
            id="outsideSearch"
            type="button">
            Find Buses
          </button>
        </div>

        <div id="outsideResults" class="outside-results"></div>

      </div>
    </section>

    <footer class="site-footer">
    <div class="footer-line primary">
      Created by <span class="name">Krishna Murari</span>
    </div>

    <div class="footer-line secondary">
      Vibro-Acoustic Lab ¬∑ IIT Palakkad (Alumni)
    </div>

    <div class="footer-line version">
      Version: <span id="appVersion">Loading...</span>
    </div>
  </footer>


  </main>

  <!-- Scripts: Load in correct order -->
  <script src="js/analytics.js"></script>
  <script src="js/clock.js" defer></script>
  <script src="js/routeEngine.js"></script>
  <script src="js/app.js"></script>
  <script src="js/install.js"></script>

</body>
</html>
